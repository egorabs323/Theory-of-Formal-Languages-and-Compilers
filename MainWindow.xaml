<Window x:Class="YourNamespace.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Текстовый редактор с выполнением кода" Height="600" Width="800"
        MinHeight="400" MinWidth="600">

    <Window.Resources>
        <Style x:Key="ToolbarButtonStyle" TargetType="Button">
            <Setter Property="Width" Value="32"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Margin" Value="2"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="FontFamily" Value="Segoe UI Emoji"/>
            <Setter Property="FontSize" Value="16"/>
        </Style>
    </Window.Resources>

    <DockPanel>
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="_Файл">
                <MenuItem Header="_Создать" Click="Create_Click" InputGestureText="Ctrl+N"/>
                <MenuItem Header="_Открыть" Click="Open_Click" InputGestureText="Ctrl+O"/>
                <MenuItem Header="_Сохранить" Click="Save_Click" InputGestureText="Ctrl+S"/>
                <MenuItem Header="Со_хранить как..." Click="SaveAs_Click"/>
                <Separator/>
                <MenuItem Header="_Выход" Click="Exit_Click"/>
            </MenuItem>

            <MenuItem Header="_Правка">
                <MenuItem Header="_Отменить" Click="Undo_Click" InputGestureText="Ctrl+Z"/>
                <MenuItem Header="_Повторить" Click="Redo_Click" InputGestureText="Ctrl+Y"/>
                <MenuItem Header="В_ырезать" Click="Cut_Click" InputGestureText="Ctrl+X"/>
                <MenuItem Header="_Копировать" Click="Copy_Click" InputGestureText="Ctrl+C"/>
                <MenuItem Header="_Вставить" Click="Paste_Click" InputGestureText="Ctrl+V"/>
                <MenuItem Header="_Удалить" Click="Delete_Click" InputGestureText="Del"/>
                <Separator/>
                <MenuItem Header="Выделить _все" Click="SelectAll_Click" InputGestureText="Ctrl+A"/>
            </MenuItem>

            <MenuItem Header="_Справка">
                <MenuItem Header="_Руководство пользователя" Click="UserGuide_Click"/>
                <MenuItem Header="_О программе" Click="About_Click"/>
            </MenuItem>
        </Menu>

        <ToolBarTray DockPanel.Dock="Top">
            <ToolBar ToolBarTray.IsLocked="True">
                <Button Style="{StaticResource ToolbarButtonStyle}" 
                        Click="Create_Click" 
                        ToolTip="Создать новый документ (Ctrl+N)">
                    <TextBlock Text="📄" TextAlignment="Center"/>
                </Button>

                <Button Style="{StaticResource ToolbarButtonStyle}" 
                        Click="Open_Click" 
                        ToolTip="Открыть документ (Ctrl+O)">
                    <TextBlock Text="📂" TextAlignment="Center"/>
                </Button>

                <Button Style="{StaticResource ToolbarButtonStyle}" 
                        Click="Save_Click" 
                        ToolTip="Сохранить документ (Ctrl+S)">
                    <TextBlock Text="💾" TextAlignment="Center"/>
                </Button>

                <Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" Margin="5"/>

                <Button Style="{StaticResource ToolbarButtonStyle}" 
                        Click="Undo_Click" 
                        ToolTip="Отменить действие (Ctrl+Z)">
                    <TextBlock Text="↩️" TextAlignment="Center"/>
                </Button>

                <Button Style="{StaticResource ToolbarButtonStyle}" 
                        Click="Redo_Click" 
                        ToolTip="Повторить действие (Ctrl+Y)">
                    <TextBlock Text="↪️" TextAlignment="Center"/>
                </Button>

                <Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" Margin="5"/>

                <Button Style="{StaticResource ToolbarButtonStyle}" 
                        Click="Cut_Click" 
                        ToolTip="Вырезать (Ctrl+X)">
                    <TextBlock Text="✂️" TextAlignment="Center"/>
                </Button>

                <Button Style="{StaticResource ToolbarButtonStyle}" 
                        Click="Copy_Click" 
                        ToolTip="Копировать (Ctrl+C)">
                    <TextBlock Text="📋" TextAlignment="Center"/>
                </Button>

                <Button Style="{StaticResource ToolbarButtonStyle}" 
                        Click="Paste_Click" 
                        ToolTip="Вставить (Ctrl+V)">
                    <TextBlock Text="📋" TextAlignment="Center"/>
                </Button>

                <Button Style="{StaticResource ToolbarButtonStyle}" 
                        Click="Delete_Click" 
                        ToolTip="Удалить (Del)">
                    <TextBlock Text="🗑️" TextAlignment="Center"/>
                </Button>

                <Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" Margin="5"/>

                <Button Style="{StaticResource ToolbarButtonStyle}" 
                        Click="UserGuide_Click" 
                        ToolTip="Руководство пользователя">
                    <TextBlock Text="❓" TextAlignment="Center"/>
                </Button>

                <Button Style="{StaticResource ToolbarButtonStyle}" 
                        Click="About_Click" 
                        ToolTip="Информация о программе">
                    <TextBlock Text="ℹ️" TextAlignment="Center"/>
                </Button>
            </ToolBar>
        </ToolBarTray>

        <Grid DockPanel.Dock="Bottom">
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="5"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <GroupBox Grid.Row="0" Header="Код для выполнения" Margin="5">
                <ScrollViewer>
                    <TextBox Name="CodeInputTextBox" 
                             AcceptsReturn="True" 
                             AcceptsTab="True" 
                             TextWrapping="Wrap" 
                             VerticalScrollBarVisibility="Auto" 
                             HorizontalScrollBarVisibility="Auto"
                             FontFamily="Consolas"
                             FontSize="12"/>
                </ScrollViewer>
            </GroupBox>

            <GridSplitter Grid.Row="1" 
                          Height="5" 
                          Background="LightGray" 
                          ResizeBehavior="PreviousAndNext"
                          HorizontalAlignment="Stretch"/>

            <GroupBox Grid.Row="2" Header="Результат выполнения" Margin="5">
                <ScrollViewer>
                    <TextBox Name="ResultOutputTextBox" 
                             IsReadOnly="True" 
                             TextWrapping="Wrap" 
                             VerticalScrollBarVisibility="Auto" 
                             HorizontalScrollBarVisibility="Auto"
                             FontFamily="Consolas"
                             FontSize="12"/>
                </ScrollViewer>
            </GroupBox>
        </Grid>
    </DockPanel>
</Window>