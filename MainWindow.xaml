<Window x:Class="YourNamespace.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        Title="Текстовый редактор" Height="600" Width="800"
        MinHeight="400" MinWidth="600" Background="#2D2D2D">

    <Window.Resources>
        <Style x:Key="ToolbarButtonStyle" TargetType="Button">
            <Setter Property="Width" Value="32"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Margin" Value="2"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="FontFamily" Value="Segoe UI Emoji"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="Background" Value="#4A235A"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#9B59B6"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#6C3483"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#5B2C6F"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="GroupBoxStyle" TargetType="GroupBox">
            <Setter Property="Background" Value="#3C3C3C"/>
            <Setter Property="BorderBrush" Value="#9B59B6"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="Foreground" Value="White"/>
        </Style>

        <Style x:Key="CodeTextBoxStyle" TargetType="TextBox">
            <Setter Property="Background" Value="#2C2C2C"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontFamily" Value="Consolas"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="AcceptsReturn" Value="True"/>
            <Setter Property="AcceptsTab" Value="True"/>
            <Setter Property="TextWrapping" Value="NoWrap"/>
            <Setter Property="VerticalScrollBarVisibility" Value="Visible"/>
            <Setter Property="HorizontalScrollBarVisibility" Value="Auto"/>
        </Style>

        <LinearGradientBrush x:Key="HeaderBackground" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#6C3483" Offset="0"/>
            <GradientStop Color="#9B59B6" Offset="1"/>
        </LinearGradientBrush>
    </Window.Resources>

    <DockPanel>
        <Menu DockPanel.Dock="Top" Background="#4A235A" Foreground="White">
            <MenuItem Header="_Файл" Background="#4A235A" Foreground="White">
                <MenuItem Header="_Создать" Click="Create_Click" InputGestureText="Ctrl+N" Background="#6C3483" Foreground="White"/>
                <MenuItem Header="_Открыть" Click="Open_Click" InputGestureText="Ctrl+O" Background="#6C3483" Foreground="White"/>
                <MenuItem Header="_Сохранить" Click="Save_Click" InputGestureText="Ctrl+S" Background="#6C3483" Foreground="White"/>
                <MenuItem Header="Со_хранить как..." Click="SaveAs_Click" Background="#6C3483" Foreground="White"/>
                <MenuItem Header="_Закрыть" Click="Close_Click" InputGestureText="Ctrl+W" Background="#6C3483" Foreground="White"/>
                <Separator Background="#9B59B6"/>
                <MenuItem Header="_Выход" Click="Exit_Click" Background="#6C3483" Foreground="White"/>
            </MenuItem>

            <MenuItem Header="_Правка" Background="#4A235A" Foreground="White">
                <MenuItem Header="_Отменить" Click="Undo_Click" InputGestureText="Ctrl+Z" Background="#6C3483" Foreground="White"/>
                <MenuItem Header="_Повторить" Click="Redo_Click" InputGestureText="Ctrl+Y" Background="#6C3483" Foreground="White"/>
                <MenuItem Header="В_ырезать" Click="Cut_Click" InputGestureText="Ctrl+X" Background="#6C3483" Foreground="White"/>
                <MenuItem Header="_Копировать" Click="Copy_Click" InputGestureText="Ctrl+C" Background="#6C3483" Foreground="White"/>
                <MenuItem Header="_Вставить" Click="Paste_Click" InputGestureText="Ctrl+V" Background="#6C3483" Foreground="White"/>
                <MenuItem Header="_Удалить" Click="Delete_Click" InputGestureText="Del" Background="#6C3483" Foreground="White"/>
                <Separator Background="#9B59B6"/>
                <MenuItem Header="Выделить _все" Click="SelectAll_Click" InputGestureText="Ctrl+A" Background="#6C3483" Foreground="White"/>
            </MenuItem>

            <MenuItem Header="_Справка" Background="#4A235A" Foreground="White">
                <MenuItem Header="_Руководство пользователя" Click="UserGuide_Click" Background="#6C3483" Foreground="White"/>
                <MenuItem Header="_О программе" Click="About_Click" Background="#6C3483" Foreground="White"/>
            </MenuItem>

            <MenuItem Header="_Вид" Background="#4A235A" Foreground="White">
                <MenuItem Header="Размер шрифта" Background="#6C3483" Foreground="White">
                    <MenuItem Header="10" Tag="10" Click="FontSize_Click" Background="#6C3483" Foreground="White"/>
                    <MenuItem Header="12" Tag="12" Click="FontSize_Click" Background="#6C3483" Foreground="White"/>
                    <MenuItem Header="14" Tag="14" Click="FontSize_Click" Background="#6C3483" Foreground="White"/>
                    <MenuItem Header="16" Tag="16" Click="FontSize_Click" Background="#6C3483" Foreground="White"/>
                    <MenuItem Header="18" Tag="18" Click="FontSize_Click" Background="#6C3483" Foreground="White"/>
                    <MenuItem Header="20" Tag="20" Click="FontSize_Click" Background="#6C3483" Foreground="White"/>
                    <MenuItem Header="22" Tag="22" Click="FontSize_Click" Background="#6C3483" Foreground="White"/>
                    <MenuItem Header="24" Tag="24" Click="FontSize_Click" Background="#6C3483" Foreground="White"/>
                </MenuItem>
            </MenuItem>

            <MenuItem Header="Язык интерфейса" Background="#6C3483" Foreground="White">
                <MenuItem Header="Русский" Tag="ru-RU" Click="Language_Click" Background="#6C3483" Foreground="White"/>
                <MenuItem Header="English" Tag="en-US" Click="Language_Click" Background="#6C3483" Foreground="White"/>
            </MenuItem>
        </Menu>

        <ToolBarTray DockPanel.Dock="Top" Background="#3C3C3C">
            <ToolBar ToolBarTray.IsLocked="True" Background="#3C3C3C">
                <Button Style="{StaticResource ToolbarButtonStyle}" 
                Click="Create_Click" 
                ToolTip="Создать новый документ (Ctrl+N)">
                    <TextBlock Text="📄" TextAlignment="Center"/>
                </Button>

                <Button Style="{StaticResource ToolbarButtonStyle}" 
                Click="Open_Click" 
                ToolTip="Открыть документ (Ctrl+O)">
                    <TextBlock Text="📂" TextAlignment="Center"/>
                </Button>

                <Button Style="{StaticResource ToolbarButtonStyle}" 
                Click="Save_Click" 
                ToolTip="Сохранить (Ctrl+S)">
                    <TextBlock Text="💾" TextAlignment="Center"/>
                </Button>

                <Button Style="{StaticResource ToolbarButtonStyle}" 
                Click="SaveAs_Click" 
                ToolTip="Сохранить как">
                    <TextBlock Text="📝" TextAlignment="Center"/>
                </Button>
                <Button Style="{StaticResource ToolbarButtonStyle}" 
                     Click="Close_Click" 
                     ToolTip="Закрыть текущий документ (Ctrl+W)">
                    <TextBlock Text="❌" TextAlignment="Center"/>
                </Button>
                <Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" Margin="5" Background="#9B59B6"/>

                <Button Style="{StaticResource ToolbarButtonStyle}" 
                Click="Undo_Click" 
                ToolTip="Отменить действие (Ctrl+Z)">
                    <TextBlock Text="↩️" TextAlignment="Center"/>
                </Button>

                <Button Style="{StaticResource ToolbarButtonStyle}" 
                Click="Redo_Click" 
                ToolTip="Повторить действие (Ctrl+Y)">
                    <TextBlock Text="↪️" TextAlignment="Center"/>
                </Button>

                <Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" Margin="5" Background="#9B59B6"/>

                <Button Style="{StaticResource ToolbarButtonStyle}" 
                Click="Cut_Click" 
                ToolTip="Вырезать (Ctrl+X)">
                    <TextBlock Text="✂️" TextAlignment="Center"/>
                </Button>

                <Button Style="{StaticResource ToolbarButtonStyle}" 
                Click="Copy_Click" 
                ToolTip="Копировать (Ctrl+C)">
                    <TextBlock Text="📋" TextAlignment="Center"/>
                </Button>

                <Button Style="{StaticResource ToolbarButtonStyle}" 
                Click="Paste_Click" 
                ToolTip="Вставить (Ctrl+V)">
                    <TextBlock Text="📋" TextAlignment="Center"/>
                </Button>

                <Button Style="{StaticResource ToolbarButtonStyle}" 
                Click="Delete_Click" 
                ToolTip="Удалить (Del)">
                    <TextBlock Text="🗑️" TextAlignment="Center"/>
                </Button>

                <Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" Margin="5" Background="#9B59B6"/>

                <Button Style="{StaticResource ToolbarButtonStyle}" 
                Click="UserGuide_Click" 
                ToolTip="Руководство пользователя">
                    <TextBlock Text="📖" TextAlignment="Center"/>
                </Button>

                <Button Style="{StaticResource ToolbarButtonStyle}" 
                Click="About_Click" 
                ToolTip="Информация о программе">
                    <TextBlock Text="ℹ️" TextAlignment="Center"/>
                </Button>
            </ToolBar>
        </ToolBarTray>

        <Grid DockPanel.Dock="Bottom">
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="5"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <GroupBox Grid.Row="0" Header="Код для выполнения" Margin="5" Style="{StaticResource GroupBoxStyle}">
                <TabControl x:Name="CodeTabs" Background="#3C3C3C">
                    <TabItem Header="Новый документ 1">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <Border Grid.Column="0" Background="#3C3C3C" BorderBrush="#9B59B6" BorderThickness="0,0,1,0">
                                <ScrollViewer x:Name="LineNumbersScrollViewer" VerticalScrollBarVisibility="Hidden" HorizontalScrollBarVisibility="Disabled">
                                    <TextBlock x:Name="LineNumbersTextBlock" 
                                               Text="1" 
                                               Padding="5,0,5,0" 
                                               VerticalAlignment="Top"
                                               Foreground="Gray"
                                               FontFamily="Consolas"
                                               FontSize="12"/>
                                </ScrollViewer>
                            </Border>

                            <TextBox x:Name="CodeInputTextBox" 
                                   Grid.Column="1"
                                   Style="{StaticResource CodeTextBoxStyle}"/>
                        </Grid>
                    </TabItem>
                </TabControl>
            </GroupBox>

            <GridSplitter Grid.Row="1" 
                          Height="5" 
                          Background="#9B59B6" 
                          ResizeBehavior="PreviousAndNext"
                          HorizontalAlignment="Stretch"/>

            <GroupBox Grid.Row="2" Header="Результат выполнения" Margin="5" Style="{StaticResource GroupBoxStyle}">
                <ScrollViewer>
                    <TextBox x:Name="ResultOutputTextBox" 
                             IsReadOnly="True" 
                             TextWrapping="Wrap" 
                             VerticalScrollBarVisibility="Auto" 
                             HorizontalScrollBarVisibility="Auto"
                             Background="#2C2C2C"
                             Foreground="White"
                             FontFamily="Consolas"
                             FontSize="12"/>
                </ScrollViewer>
            </GroupBox>
        </Grid>
    </DockPanel>
</Window>